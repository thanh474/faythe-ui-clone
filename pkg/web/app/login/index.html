<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <link rel="icon" type="image/png" sizes="96x96" href="./img/favicon.png">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title>Faythe UI</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" type="text/css" href="./css/login.css">
    <script src="./js/jquery.min.js"></script>
    <script src="./js/md5.min.js"></script>
</head>
<body>
<form id="login" action="/auth" method="POST">
    <div class="imgcontainer">
        <img src="./img/logo.png" alt="Avatar" class="avatar">
    </div>
    <div class="alert" style="display: none; text-align: center">
        <strong>Unauthorized!</strong><br>
        Please check username and password!
    </div>
    <div class="container">
        <input type="text" placeholder="Username" name="uname" required id="uname">

        <input type="password" placeholder="Password" name="psw" required id="password">

        <button type="submit">Login</button>
    </div>
</form>
<script>
    $(document).ready(function () {
        $("#login").submit(function (event) {
            event.preventDefault(); //prevent default action
            $(".alert").hide();
            let post_url = $(this).attr("action"); //get form action url
            let request_method = $(this).attr("method"); //get form GET/POST method
            $.ajax({
                url: post_url,
                type: request_method,
                data: JSON.stringify({
                    username: $("#uname").val(),
                    password: hex_md5($("#password").val())
                }),
                contentType: "application/json; charset=utf-8",
                cache: false,
                processData: false,
                success: () => window.location.href = "/",
                error: function () {
                    $(".alert").show();
                }
            });
        });
    });
</script>
</body>
</html>

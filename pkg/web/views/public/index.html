<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
    <title>Faythe UI</title>
    <script type="text/javascript" src="/static/public/js/vue.min.js"></script>
    <script type="text/javascript" src="/static/public/js/axios.min.js"></script>
    <script type="text/javascript" src="/static/public/js/md5.min.js"></script>
    <link rel="stylesheet" href="/static/public/css/style.css" type="text/css">
</head>
<body>
<section id="login" v-bind:class="isShake">
    <form>
        <h2>Login</h2>
        <div class="info" v-bind:class="good">
            <p>{{ alert.message }}</p>
        </div>
        <input type="text" v-model="login.username" placeholder="Username"/>
        <input type="password" v-model="login.password" placeholder="Password"/>
        <button v-on:click="onSubmit">Log in</button>
    </form>
</section>
<script type="text/javascript">
    let vue = new Vue({
        el: "#login",
        data: {
            alert: {
                message: ""
            },
            login: {
                username: "",
                password: ""
            },
            shake: false,
            good: "",
        },
        computed: {
            isShake: function(){
                if(this.shake == true){
                    return 'shake'
                }
                return 'none'
            }
        },
        methods: {
            onSubmit: function (event) {
                event.preventDefault();
                this.shake = false
                axios({
                    method: "post",
                    url: "/public/auth",
                    data: {
                        username: this.login.username,
                        password: hex_md5(this.login.password)
                    },
                })
                    .then(response => {
                        window.location.href = "/home"
                    })
                    .catch(error => {
                        this.shake = true
                        this.login.password = ""
                        this.alert.message = "Username/Password is not correct!"
                    })
            }
        }
    });
</script>
</body>
</html>